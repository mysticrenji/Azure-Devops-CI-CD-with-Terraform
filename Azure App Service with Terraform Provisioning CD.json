{"source":2,"revision":36,"description":null,"createdBy":{"displayName":"Rockstar","url":"https://spsprodea1.vssps.visualstudio.com/Af6ff45a5-e884-460a-82dd-c4141699ef59/_apis/Identities/d55fab3b-1646-6e49-b052-c2869b9c13f6","_links":{"avatar":{"href":"https://dev.azure.com/Azrockstar/_apis/GraphProfile/MemberAvatars/msa.ZDU1ZmFiM2ItMTY0Ni03ZTQ5LWIwNTItYzI4NjliOWMxM2Y2"}},"id":"d55fab3b-1646-6e49-b052-c2869b9c13f6","uniqueName":"Az_rockstar@outlook.com","imageUrl":"https://dev.azure.com/Azrockstar/_apis/GraphProfile/MemberAvatars/msa.ZDU1ZmFiM2ItMTY0Ni03ZTQ5LWIwNTItYzI4NjliOWMxM2Y2","descriptor":"msa.ZDU1ZmFiM2ItMTY0Ni03ZTQ5LWIwNTItYzI4NjliOWMxM2Y2"},"createdOn":"2020-02-19T06:49:01.173Z","modifiedBy":{"displayName":"Rockstar","url":"https://spsprodea1.vssps.visualstudio.com/Af6ff45a5-e884-460a-82dd-c4141699ef59/_apis/Identities/d55fab3b-1646-6e49-b052-c2869b9c13f6","_links":{"avatar":{"href":"https://dev.azure.com/Azrockstar/_apis/GraphProfile/MemberAvatars/msa.ZDU1ZmFiM2ItMTY0Ni03ZTQ5LWIwNTItYzI4NjliOWMxM2Y2"}},"id":"d55fab3b-1646-6e49-b052-c2869b9c13f6","uniqueName":"Az_rockstar@outlook.com","imageUrl":"https://dev.azure.com/Azrockstar/_apis/GraphProfile/MemberAvatars/msa.ZDU1ZmFiM2ItMTY0Ni03ZTQ5LWIwNTItYzI4NjliOWMxM2Y2","descriptor":"msa.ZDU1ZmFiM2ItMTY0Ni03ZTQ5LWIwNTItYzI4NjliOWMxM2Y2"},"modifiedOn":"2020-02-20T08:36:55.520Z","isDeleted":false,"lastRelease":{"id":42,"name":"Release-40","artifacts":[],"_links":{},"description":"","releaseDefinition":{"id":2,"projectReference":null,"_links":{}},"createdOn":"2020-02-26T14:00:02.493Z","createdBy":{"displayName":"Rockstar","url":"https://spsprodea1.vssps.visualstudio.com/Af6ff45a5-e884-460a-82dd-c4141699ef59/_apis/Identities/d55fab3b-1646-6e49-b052-c2869b9c13f6","_links":{"avatar":{"href":"https://dev.azure.com/Azrockstar/_apis/GraphProfile/MemberAvatars/msa.ZDU1ZmFiM2ItMTY0Ni03ZTQ5LWIwNTItYzI4NjliOWMxM2Y2"}},"id":"d55fab3b-1646-6e49-b052-c2869b9c13f6","uniqueName":"Az_rockstar@outlook.com","imageUrl":"https://dev.azure.com/Azrockstar/_apis/GraphProfile/MemberAvatars/msa.ZDU1ZmFiM2ItMTY0Ni03ZTQ5LWIwNTItYzI4NjliOWMxM2Y2","descriptor":"msa.ZDU1ZmFiM2ItMTY0Ni03ZTQ5LWIwNTItYzI4NjliOWMxM2Y2"}},"variables":{"appresourcegroup":{"value":"terraform-rg-kingkobra"},"appresourcegrouplocation":{"value":"West US"},"appservicename":{"value":"terraform-appservice-kingkobra"},"appserviceplan":{"value":"terraform-appserviceplan-kingkobra"},"storagekey":{"value":"PipelineWillGetThisValueRuntime"},"terraformcontainername":{"value":"terraformcontainermysticrenji"},"terraformstorageaccount":{"value":"terraformstoragedb1988"},"terraformstoragerg":{"value":"terraformrg1988"}},"variableGroups":[],"environments":[{"id":2,"name":"Dev","rank":1,"owner":{"displayName":"Rockstar","url":"https://spsprodea1.vssps.visualstudio.com/Af6ff45a5-e884-460a-82dd-c4141699ef59/_apis/Identities/d55fab3b-1646-6e49-b052-c2869b9c13f6","_links":{"avatar":{"href":"https://dev.azure.com/Azrockstar/_apis/GraphProfile/MemberAvatars/msa.ZDU1ZmFiM2ItMTY0Ni03ZTQ5LWIwNTItYzI4NjliOWMxM2Y2"}},"id":"d55fab3b-1646-6e49-b052-c2869b9c13f6","uniqueName":"Az_rockstar@outlook.com","imageUrl":"https://dev.azure.com/Azrockstar/_apis/GraphProfile/MemberAvatars/msa.ZDU1ZmFiM2ItMTY0Ni03ZTQ5LWIwNTItYzI4NjliOWMxM2Y2","descriptor":"msa.ZDU1ZmFiM2ItMTY0Ni03ZTQ5LWIwNTItYzI4NjliOWMxM2Y2"},"variables":{},"variableGroups":[],"preDeployApprovals":{"approvals":[{"rank":1,"isAutomated":true,"isNotificationOn":false,"id":4}],"approvalOptions":{"requiredApproverCount":null,"releaseCreatorCanBeApprover":false,"autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped":false,"enforceIdentityRevalidation":false,"timeoutInMinutes":0,"executionOrder":1}},"deployStep":{"id":5},"postDeployApprovals":{"approvals":[{"rank":1,"isAutomated":true,"isNotificationOn":false,"id":6}],"approvalOptions":{"requiredApproverCount":null,"releaseCreatorCanBeApprover":false,"autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped":false,"enforceIdentityRevalidation":false,"timeoutInMinutes":0,"executionOrder":2}},"deployPhases":[{"deploymentInput":{"parallelExecution":{"parallelExecutionType":0},"agentSpecification":{"identifier":"vs2017-win2016"},"skipArtifactsDownload":false,"artifactsDownloadInput":{"downloadInputs":[]},"queueId":39,"demands":[],"enableAccessToken":false,"timeoutInMinutes":0,"jobCancelTimeoutInMinutes":1,"condition":"succeeded()","overrideInputs":{}},"rank":1,"phaseType":1,"name":"Agent job","refName":null,"workflowTasks":[{"environment":{},"taskId":"46e4be58-730b-4389-8a2f-ea10b3e5e815","version":"1.*","name":"Azure CLI to deploy required Azure resources","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"connectedServiceNameARM":"eda8240a-ba8f-4b48-868a-adbd92d37ff5","scriptLocation":"inlineScript","scriptPath":"","inlineScript":"# this will create Azure resource group\ncall az group create --location westus --name $(terraformstoragerg)\n\ncall az storage account create --name $(terraformstorageaccount) --resource-group $(terraformstoragerg) --location westus --sku Standard_LRS\n\ncall az storage container create --name terraform --account-name $(terraformstorageaccount)\n\ncall az storage account keys list -g $(terraformstoragerg) -n $(terraformstorageaccount)","args":"","addSpnToEnvironment":"false","useGlobalConfig":"false","cwd":"","failOnStandardError":"false"}},{"environment":{},"taskId":"72a1931b-effb-4d2e-8fd8-f8472a07cb62","version":"3.*","name":"Azure PowerShell script to get the storage key","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"ConnectedServiceNameSelector":"ConnectedServiceNameARM","ConnectedServiceName":"","ConnectedServiceNameARM":"eda8240a-ba8f-4b48-868a-adbd92d37ff5","ScriptType":"InlineScript","ScriptPath":"","Inline":"# Using this script we will fetch storage key which is required in terraform file to authenticate backend stoarge account\n\n$key=(Get-AzureRmStorageAccountKey -ResourceGroupName $(terraformstoragerg) -AccountName $(terraformstorageaccount)).Value[0]\n\nWrite-Host \"##vso[task.setvariable variable=storagekey]$key\"","ScriptArguments":"","errorActionPreference":"stop","FailOnStandardError":"false","TargetAzurePs":"LatestVersion","CustomTargetAzurePs":""}},{"environment":{},"taskId":"a8515ec8-7254-4ffd-912c-86772e2b5962","version":"3.*","name":"Replace tokens in Terraform file","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"rootDirectory":"$(System.DefaultWorkingDirectory)/_Azure App Service with Terraform Provisioning CI/drop","targetFiles":"*.tf","encoding":"auto","writeBOM":"true","escapeType":"none","escapeChar":"","charsToEscape":"","verbosity":"normal","actionOnMissing":"warn","keepToken":"false","tokenPrefix":"__","tokenSuffix":"__","emptyValue":"(empty)"}},{"environment":{},"taskId":"11645770-d18e-11e8-8f5b-1b8b62612b3b","version":"0.*","name":"Use Terraform  0.12.21","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"terraformVersion":" 0.12.21"}},{"environment":{},"taskId":"721c3f90-d938-11e8-9d92-09d7594721b5","version":"0.*","name":"terraform init","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"command":"init","workingDirectory":"$(System.DefaultWorkingDirectory)/_Azure App Service with Terraform Provisioning CI/drop","environmentServiceName":"","secureVarsFile":"","commandOptions":"","backendType":"azurerm","backendServiceArm":"eda8240a-ba8f-4b48-868a-adbd92d37ff5","ensureBackend":"false","backendAzureRmResourceGroupName":"$(terraformstoragerg)","backendAzureRmResourceGroupLocation":"westus","backendAzureRmStorageAccountName":"$(terraformstorageaccount) ","backendAzureRmStorageAccountSku":"Standard_LRS","backendAzureRmContainerName":"terraform","backendAzureRmKey":"terraform.tfstate","aiInstrumentationKey":"ec11a02f-c97a-4b55-8005-acf129682668"}},{"environment":{},"taskId":"721c3f90-d938-11e8-9d92-09d7594721b5","version":"0.*","name":"terraform plan","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"command":"plan","workingDirectory":"$(System.DefaultWorkingDirectory)/_Azure App Service with Terraform Provisioning CI/drop","environmentServiceName":"eda8240a-ba8f-4b48-868a-adbd92d37ff5","secureVarsFile":"","commandOptions":"","backendType":"local","backendServiceArm":"","ensureBackend":"false","backendAzureRmResourceGroupName":"","backendAzureRmResourceGroupLocation":"","backendAzureRmStorageAccountName":"","backendAzureRmStorageAccountSku":"Standard_RAGRS","backendAzureRmContainerName":"","backendAzureRmKey":"","aiInstrumentationKey":"ec11a02f-c97a-4b55-8005-acf129682668"}},{"environment":{},"taskId":"721c3f90-d938-11e8-9d92-09d7594721b5","version":"0.*","name":"terraform apply","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"command":"apply","workingDirectory":"$(System.DefaultWorkingDirectory)/_Azure App Service with Terraform Provisioning CI/drop","environmentServiceName":"eda8240a-ba8f-4b48-868a-adbd92d37ff5","secureVarsFile":"","commandOptions":"","backendType":"local","backendServiceArm":"","ensureBackend":"false","backendAzureRmResourceGroupName":"","backendAzureRmResourceGroupLocation":"","backendAzureRmStorageAccountName":"","backendAzureRmStorageAccountSku":"Standard_RAGRS","backendAzureRmContainerName":"","backendAzureRmKey":"","aiInstrumentationKey":"ec11a02f-c97a-4b55-8005-acf129682668"}},{"environment":{},"taskId":"497d490f-eea7-4f2b-ab94-48d9c1acdcb1","version":"4.*","name":"Azure App Service Deploy:  Web App","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"ConnectionType":"AzureRM","ConnectedServiceName":"eda8240a-ba8f-4b48-868a-adbd92d37ff5","PublishProfilePath":"$(System.DefaultWorkingDirectory)/**/*.pubxml","PublishProfilePassword":"","WebAppKind":"webApp","WebAppName":"terraform-appservice-kingkobra","DeployToSlotOrASEFlag":"false","ResourceGroupName":"","SlotName":"production","DockerNamespace":"","DockerRepository":"","DockerImageTag":"","VirtualApplication":"","Package":"$(System.DefaultWorkingDirectory)/**/*.zip","RuntimeStack":"","RuntimeStackFunction":"","StartupCommand":"","ScriptType":"","InlineScript":":: You can provide your deployment commands here. One command per line.","ScriptPath":"","WebConfigParameters":"","AppSettings":"","ConfigurationSettings":"","UseWebDeploy":"false","DeploymentType":"webDeploy","TakeAppOfflineFlag":"true","SetParametersFile":"","RemoveAdditionalFilesFlag":"false","ExcludeFilesFromAppDataFlag":"true","AdditionalArguments":"-retryAttempts:6 -retryInterval:10000","RenameFilesFlag":"true","XmlTransformation":"false","XmlVariableSubstitution":"false","JSONFiles":""}},{"environment":{},"taskId":"f045e430-8704-11e6-968f-e717e6411619","version":"0.*","name":"Restart Azure App Service: Web App","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"ConnectedServiceName":"eda8240a-ba8f-4b48-868a-adbd92d37ff5","Action":"Restart Azure App Service","WebAppName":"$(appservicename)","SpecifySlot":"false","ResourceGroupName":"","SourceSlot":"","SwapWithProduction":"true","TargetSlot":"","PreserveVnet":"false","Slot":"production","ExtensionsList":"","OutputVariable":"","AppInsightsResourceGroupName":"","ApplicationInsightsResourceName":"","ApplicationInsightsWebTestName":""}}]}],"environmentOptions":{"emailNotificationType":"OnlyOnFailure","emailRecipients":"release.environment.owner;release.creator","skipArtifactsDownload":false,"timeoutInMinutes":0,"enableAccessToken":false,"publishDeploymentStatus":true,"badgeEnabled":false,"autoLinkWorkItems":false,"pullRequestDeploymentEnabled":false},"demands":[],"conditions":[{"name":"ReleaseStarted","conditionType":1,"value":""}],"executionPolicy":{"concurrencyCount":1,"queueDepthCount":0},"schedules":[],"currentRelease":{"id":42,"url":"https://vsrm.dev.azure.com/Azrockstar/6634ca38-b1c8-4f77-bb7e-8aa35e36a33e/_apis/Release/releases/42","_links":{}},"retentionPolicy":{"daysToKeep":30,"releasesToKeep":3,"retainBuild":true},"processParameters":{},"properties":{"BoardsEnvironmentType":{"$type":"System.String","$value":"unmapped"},"LinkBoardsWorkItems":{"$type":"System.String","$value":"False"}},"preDeploymentGates":{"id":0,"gatesOptions":null,"gates":[]},"postDeploymentGates":{"id":0,"gatesOptions":null,"gates":[]},"environmentTriggers":[],"badgeUrl":"https://vsrm.dev.azure.com/Azrockstar/_apis/public/Release/badge/6634ca38-b1c8-4f77-bb7e-8aa35e36a33e/2/2"}],"artifacts":[{"sourceId":"6634ca38-b1c8-4f77-bb7e-8aa35e36a33e:5","type":"Build","alias":"_Azure App Service with Terraform Provisioning CI","definitionReference":{"artifactSourceDefinitionUrl":{"id":"https://dev.azure.com/Azrockstar/_permalink/_build/index?collectionId=cbe79fd6-f4c5-430c-aa1a-fa16285bbeac&projectId=6634ca38-b1c8-4f77-bb7e-8aa35e36a33e&definitionId=5","name":""},"defaultVersionBranch":{"id":"","name":""},"defaultVersionSpecific":{"id":"","name":""},"defaultVersionTags":{"id":"","name":""},"defaultVersionType":{"id":"latestType","name":"Latest"},"definition":{"id":"5","name":"Azure App Service with Terraform Provisioning CI"},"definitions":{"id":"","name":""},"IsMultiDefinitionType":{"id":"False","name":"False"},"project":{"id":"6634ca38-b1c8-4f77-bb7e-8aa35e36a33e","name":"AzureAppService_CICD"},"repository":{"id":"","name":""}},"isPrimary":true,"isRetained":false}],"triggers":[],"releaseNameFormat":"Release-$(rev:r)","tags":[],"properties":{"DefinitionCreationSource":{"$type":"System.String","$value":"ReleaseNew"},"IntegrateBoardsWorkItems":{"$type":"System.String","$value":"False"},"IntegrateJiraWorkItems":{"$type":"System.String","$value":"false"}},"id":2,"name":"Azure App Service with Terraform Provisioning","path":"\\","projectReference":null,"url":"https://vsrm.dev.azure.com/Azrockstar/6634ca38-b1c8-4f77-bb7e-8aa35e36a33e/_apis/Release/definitions/2","_links":{"self":{"href":"https://vsrm.dev.azure.com/Azrockstar/6634ca38-b1c8-4f77-bb7e-8aa35e36a33e/_apis/Release/definitions/2"},"web":{"href":"https://dev.azure.com/Azrockstar/6634ca38-b1c8-4f77-bb7e-8aa35e36a33e/_release?definitionId=2"}}}